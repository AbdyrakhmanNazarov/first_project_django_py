{% extends 'base.html' %}
{% block blocktitle %}–í–∞—à –∫–∞–±–∏–Ω–µ—Ç{% endblock %}

{% block content %}
<h1>{{ title }}</h1>

<!-- –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ—Ä–∑–∏–Ω—É –∏ –ª–∞–π–∫–∏ -->
<div style="margin-bottom: 20px;">
  <a href="{% url 'users:cart_view' %}">–ú–æ—è –∫–æ—Ä–∑–∏–Ω–∞ ({{ request.session.cart|length|default:0 }})</a> |
  <a href="{% url 'users:liked_students' %}">–ú–æ–∏ –ª–∞–π–∫–∏ ({{ request.session.liked_students|length|default:0 }})</a>
</div>

<!-- –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ -->
<div class="students-list">
  {% for student in students %}
    <div class="student-card" style="border:1px solid #ccc; padding:15px; margin-bottom:10px;">
      <h3>{{ student.name }}</h3>
      {% if student.group %}
        <p>–ì—Ä—É–ø–ø–∞: {{ student.group.name }}</p>
      {% endif %}
      <p>–¢–µ–≥–∏: 
        {% for tag in student.tags.all %}
          {{ tag.name }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
      </p>

      <!-- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—É–¥–µ–Ω—Ç–∞ -->
      <div class="crud-buttons" style="margin-bottom:10px;">
        <a href="{% url 'custom_admin:student_detail' student.pk %}">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
      </div>

      <!-- –õ–∞–π–∫ -->
      {% if student.id in request.session.liked_students %}
        <a href="{% url 'users:like_student' student_id=student.id %}">‚ù§Ô∏è –£–±—Ä–∞—Ç—å –ª–∞–π–∫</a>
      {% else %}
        <a href="{% url 'users:like_student' student_id=student.id %}">ü§ç –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫</a>
      {% endif %}

      <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
      {% if student.id in request.session.cart %}
        <span style="margin-left:10px; color:green;">‚úî –í –∫–æ—Ä–∑–∏–Ω–µ</span>
      {% else %}
        <a href="{% url 'users:add_to_cart' student_id=student.id %}" style="margin-left:10px;">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</a>
      {% endif %}
    </div>
  {% empty %}
    <p>–°—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
  {% endfor %}
</div>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<div class="pagination" style="margin-top:15px;">
  {% if students.has_previous %}
    <a href="?page={{ students.previous_page_number }}">–ù–∞–∑–∞–¥</a>
  {% endif %}

  <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ students.number }} –∏–∑ {{ students.paginator.num_pages }}</span>

  {% if students.has_next %}
    <a href="?page={{ students.next_page_number }}">–í–ø–µ—Ä–µ–¥</a>
  {% endif %}
</div>
{% endblock %}
